@model AgendaMedica.Models.Agendar


<h1>Editar Agenda</h1>

<div>
    <form asp-action="Edit" method="post" id="formulario" onsubmit="consulta1(event)">
        <input type="hidden" asp-for="IdAg" />

        <div class="form-group">
                
                <label class="form-label">Agendar Fecha</label>
                <input type="date" class="form-control" asp-for="FechaAg" id="fecha" onblur="lostfocus('fecha')" placeholder="Agende Fecha" autocomplete="off" autofocus="on" />
                <div id="efecha"></div>
           
                <label class="form-label">Agendar Hora</label>
                <input type="time" class="form-control" asp-for="HoraAg" id="hora" onblur="lostfocus('hora')" placeholder="Agende Hora" autocomplete="off" />
                <div id="ehora"></div>
            
                <label class="form-label">Tipo de Especialidad</label>
                <select asp-for="IdEsp" class="form-select" asp-items="ViewBag.IdEspecialidad"> </select>
           
                <label class="form-label">Tipo de Atención</label>
                <select asp-for="IdAte" class="form-control" asp-items="ViewBag.IdAtenciones"></select>
            
                <label class="form-label">Rut del Paciente</label>
                <input type="text" class="form-control" asp-for="RutPac" id="rut" onblur="lostfocus('rut')" placeholder="Ingrese el Rut" autocomplete="off" />
                <div id="erut"></div>
          
                <label class="form-label">Nombre del Paciente</label>
                <input type="text" class="form-control" asp-for="NomPac" id="nombre" onblur="lostfocus('nombre')" placeholder="Ingrese el Nombre" autocomplete="off" />
                <div id="enombre"></div>
            
                <label class="form-label">Apellidos del Paciente</label>
                <input type="text" class="form-control" asp-for="ApePac" id="apellido" onblur="lostfocus('apellido')" placeholder="Ingrese el Apellido" autocomplete="off" />
                <div id="eapellido"></div>
            
                <label class="form-label">Previsión</label>
                <select asp-for="IdPrev" class="form-control" asp-items="ViewBag.IdPrevision"></select>
            
                <label class="form-label">Telefono del Paciente</label>
                <input type="tel" class="form-control" asp-for="FonoPac" id="fono" onblur="lostfocus('fono')" placeholder="Ingrese el Telefono" autocomplete="off" />
                <div id="efono"></div>
           
                <label class="form-label">Direccion del Paciente</label>
                <input type="text" class="form-control" asp-for="DirPac" id="direccion" onblur="lostfocus('direccion')" placeholder="Ingrese la Dirección" autocomplete="off" />
                <div id="edireccion"></div>
            
                <label class="form-label">Sector del paciente</label>
                <select asp-for="IdSector" class="form-control" asp-items="ViewBag.IdSectores"></select>
            </div>

        <div class="mt-3 text-end">
            <a asp-action="Index" class="btn btn-outline-info">Volver</a>
            <input type="reset" value="Limpiar" onclick="limpiar(); FocusOnInput()" class="btn btn-info" />
            <input type="submit" value="Editar" class="btn btn-outline-success" />
        </div>
    </form>
</div>

<script>

    function consulta1(e) {

        e.preventDefault();

        Swal.fire({
            title: '¿Desea guardar los cambios editados?',
            icon: 'question',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Si, Editar!'
        }).then((resultado) => {
            if (resultado.isConfirmed) {
                const formulario = document.getElementById('formulario');
                formulario.submit();
            }
        })
    }

    function validar() {
        lostfocus('fecha')
        lostfocus('hora')
        lostfocus('rut')
        lostfocus('nombre')
        lostfocus('apellido')
        lostfocus('fono')
        lostfocus('direccion')
    }

    function lostfocus(idInput) {
        // error que se mostrara en caso de estar vacio el campo
        const msjError =
            '<span class = "badge bg-danger"> El campo es obligatorio </span>'
        // valida si el campo esta vacio o no
        if (document.getElementById(idInput).value.trim() == '')
            //sirve para agregar elementos a html por js
            document.getElementById('e' + idInput).innerHTML = msjError
        else
            document.getElementById('e' + idInput).innerHTML = ''
    }

    function limpiar() {
        console.log(document.querySelectorAll('input'))
        document.querySelectorAll('.form-control').forEach(item => {
            item.value = ''
        })
        document.querySelectorAll('span').forEach(item => {
            item.innerHTML = ''
        })
    }

    function FocusOnInput() {
        document.getElementById("hora").focus();
    }

</script>